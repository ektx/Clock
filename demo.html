<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Clock</title>
<link rel="stylesheet" href="clockApp.css" />
</head>
<body>
	<div class="clock-interface">
		<div class="analog-clock">
			<!-- 表面 与 圈壳 -->
			<div class="analog-surface">
				<div id="clock-hours" class="analog-hour"></div>
				<div class="analog-min"></div>
				<div class="analog-sec"></div>
				<div class="analog-hat"></div>
			</div>
		</div>
		<div class="digital-clock">
			<div class="digital-display">
				<span>
					<i class="past"></i>
					<i class="now"></i>
					<i class="future"></i>
				</span>
				<span>
					<i class="past"></i>
					<i class="now"></i>
					<i class="future"></i>
				</span>
			</div>
			<span>:</span>
		</div>
	</div>
	
</body>
<!-- 手表部件专业命名 -> http://xiangwen518.blog.163.com/blog/static/273824922007417104438588/ -->
<script>
(function() {
	function rotate(selector, deg) {
		var el = document.querySelector(selector);
		el.style.webkitTransform = 'rotate('+ deg + 'deg)';
		el.style.transform = 'rotate('+ deg +'deg)';
	};

// 设置模拟时钟
function setAnalog() {

	var now = new Date();
	var h = now.getHours();
	var m = now.getMinutes();
	var s = now.getSeconds();
	var delayTime;
	var tables = document.querySelector('.analog-surface');
	if(h > 18 || h < 6) {
		tables.classList.add('night-analog');
		if(h > 18)
		delayTime = (12*3600 - ((h-18)*60*60 + m*60 + s))*1000;
		if(h<6)
		delayTime = ((5-h)*3600 + (59-m)*60 + (60-s))*1000;

		toDaytime(delayTime);
	} else {
		delayTime = ((17-h)*3600 + (26-m)*60 + (60-s))*1000;
		toNight(delayTime);
	}
	// console.log('delayTime'+delayTime);
	// 每分钟查询下当前时钟大小，判断是否显示为夜晚
	function toDaytime(time) {
		setTimeout(function() {
			console.log('good moring');
			tables.classList.remove('night-analog');
			delayTime = 12*3600000;
			toNight(delayTime);
		}, time);
	}
	function toNight(time) {
		setTimeout(function() {
			console.log('welcome to night');
			tables.classList.add('night-analog');
			delayTime = 12*3600000;
			toDaytime(delayTime);
		}, time);
	}

	h = (h> 11) ? h-12: h;
	rotate('.analog-hour', ((h*3600 + m*60 + s)/43200 * 360));
	rotate('.analog-min', ((m*60+s)/3600*360));
	rotate('.analog-sec', (s/60*360));
}
setAnalog();

	// 模拟时钟
var Clock = (function(){ 
	var time = new Date();
	// for (var t = 0; t< 2; t++) {
		// for (var i = 0; i<2; i++) {
	var _getTime = function() {
		var timeList = document.querySelectorAll('.now');

		timeList[0].innerHTML = time.getHours();
		timeList[1].innerHTML = time.getMinutes();
	}
	var _run = function () {
		var ilis = document.querySelectorAll('.digital-display span i');

		for (var i = 3; i < 6; i++) {
			if(ilis[i].classList.contains('now')) {
				ilis[i].className = 'future';
			} else if (ilis[i].classList.contains('future')) {
				ilis[i].className = 'past';
			} else {
				ilis[i].className = 'now';
			}
		}

	}

	var _upDate = function() {
		var nowV = document.querySelectorAll('.now');
		var pastV = document.querySelectorAll('.past');
		var isI;
		for (var s = 0; s < 2; s++) {
			if(nowV[s].innerHTML != pastV[s].innerHTML) {
				console.log('!=');
				console.log(nowV[s].innerHTML);
				console.log(pastV[s].innerHTML);
				isI = s;
				_run();
			} else {
				console.log('==');
				console.log(nowV[s].innerHTML);
				console.log(pastV[s].innerHTML);
				isI = s;
			}
		}

		setTimeout(function() {
			_upDate();
			_getTime();
		},5000);
		// var i = isI == 0?0:3;

	}

		// }
	// }
_upDate();

_getTime();
}());

}() );
</script>
</html>